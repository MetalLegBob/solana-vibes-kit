# Solana Exploit Patterns — Index & Cross-Reference
<!-- Master index for all exploit pattern files -->
<!-- Use this file for strategy generation and quick lookups -->
<!-- Last updated: 2026-02-06 -->
<!-- Total: 128 patterns across 21 categories -->

## File Map

| File | EPs | Description |
|------|-----|-------------|
| [exploit-patterns-core.md](exploit-patterns-core.md) | EP-001–067 | Foundational: validation, arithmetic, oracle, access, logic, CPI, token, economic |
| [exploit-patterns-advanced.md](exploit-patterns-advanced.md) | EP-068–097 | Operational: key mgmt, init, upgrade, DoS, race conditions, advanced bypass |
| [exploit-patterns-incidents.md](exploit-patterns-incidents.md) | EP-098–118 | Incident-derived: audit findings, bounties, niche exploits, cross-chain lessons |
| [exploit-patterns-recent.md](exploit-patterns-recent.md) | EP-119–128 | Recent: protocol-specific, infrastructure, gap analysis patterns |

## Category Directory

| # | Category | EPs | File |
|---|----------|-----|------|
| 1 | Account Validation | EP-001–014 | core |
| 2 | Arithmetic | EP-015–020 | core |
| 3 | Oracle | EP-021–025 | core |
| 4 | Access Control | EP-026–032 | core |
| 5 | Logic / State Machine | EP-033–041 | core |
| 6 | CPI | EP-042–050 | core |
| 7 | Token / SPL | EP-051–057 | core |
| 8 | Economic / DeFi | EP-058–067 | core |
| 9 | Key Management | EP-068–074 | advanced |
| 10 | Initialization | EP-075–078 | advanced |
| 11 | Upgrade / Governance | EP-079–083 | advanced |
| 12 | Resource / DoS | EP-084–088 | advanced |
| 13 | Race Conditions / MEV | EP-089–090 | advanced |
| 14 | Advanced Bypass (Wave 2) | EP-091–097 | advanced |
| 15 | Audit & Incident (Wave 3-4) | EP-098–105 | incidents |
| 16 | Bug Bounty & Disclosure (Wave 5) | EP-106–110 | incidents |
| 17 | Niche Exploits (Wave 6) | EP-111–113 | incidents |
| 18 | Cross-Chain Lessons (Wave 7) | EP-114–118 | incidents |
| 19 | Protocol-Specific (Wave 8) | EP-119–122 | recent |
| 20 | Infrastructure & Verification (Wave 9) | EP-123–125 | recent |
| 21 | Gap Analysis (Wave 10) | EP-126–128 | recent |

---

## Cross-Reference: By Real-World Incident

| Incident | Loss | Patterns |
|----------|------|----------|
| Wormhole | $326M | EP-001, EP-092 |
| Cetus DEX (SUI) | $223M | EP-015, EP-091 |
| Mango Markets | $116M | EP-021, EP-023, EP-025, EP-058 |
| Cashio | $52.8M | EP-006 |
| DEXX | $30M | EP-070, EP-097 |
| Jet Protocol | $20-25M at risk | EP-002, EP-123 (unvalidated deposit_note_account) |
| Crema Finance | $8.8M | EP-033, EP-049 |
| Slope Wallet | $8M | EP-070, EP-097 |
| Loopscale | $5.8M | EP-021, EP-096 |
| Saber | $4.6M | EP-003, EP-009, EP-017 |
| Raydium Admin Key | $4.4M | EP-068, EP-073 |
| Nirvana | $3.5M | EP-024, EP-058, EP-061 |
| Pump.fun | $1.9M | EP-068, EP-094 |
| Solend USDH Oracle | $1.26M | EP-021, EP-023, EP-120 |
| Apricot | $1.2M | EP-017, EP-020 |
| Friktion | $1M | EP-034 |
| Aurory SyncSpace | $830K | EP-093 |
| OptiFi | $661K | EP-071, EP-083 |
| Allbridge (BNB) | $570K | EP-058, EP-061 |
| Cyclos | $340K | EP-090 |
| Socean | $300K | EP-010 |
| MonkeyBall | $250K | EP-013, EP-068 |
| Port Finance | $200K | EP-016 |
| Hubble | $180K | EP-065, EP-090 |
| Dexlab | $180K | EP-041 |
| LIBRA (rug) | $286M | EP-101 |
| MELANIA (rug) | $200M | EP-101 |
| MarginFi Flash Loan | $160M at risk | EP-118 |
| DogWifTools | $10M | EP-095 |
| Marinade SAM | $5M | EP-099 |
| Aquabot (rug) | $4.65M | EP-101 |
| SolFire (rug) | $4M | EP-101 |
| MetaWin | $4M | EP-073, EP-098 |
| Texture Finance | $2.2M | EP-007, EP-050, EP-098 |
| Build Finance DAO (EVM lesson) | $470K | EP-114 (accumulation) |
| Curve/Vyper Reentrancy (EVM lesson) | $52M | Stale CPI data analog |
| Jupiter Flash Loan | $50M | EP-061, EP-118 |
| @solana/web3.js | $130K | EP-095 |
| ZK ElGamal (patched) | $0 | EP-100 |
| Hylo | Critical | EP-102 |
| Cytonic Network | Medium | EP-103 |
| Olympus DAO OFT | High | EP-104 |
| Vaultka | Critical | EP-099 (fee routing) |
| Blockstreet Launchpad | Critical | EP-105 |
| Raydium cp-swap (bounty) | $505K bounty | EP-109 |
| Raydium CLMM (bounty) | $505K bounty | EP-108 |
| Raydium CP-Swap Fee Hijack | Out of scope | EP-119 |
| Wormchain Guardian Key | $50K bounty | EP-121 |
| Metaplex pNFT Mad Shield | 3 Critical | EP-122 |
| Metaplex Bubblegum CVE | Patched | EP-122 (creator verification) |
| Solend Rent Thief | Low $ / High DoS | EP-110 |
| CLINKSINK DaaS Drainer | $900K+ | EP-095 |
| Parcl DNS Hijack | Unknown | EP-113 |
| DeezNode Sandwich | $13M (1 month) | EP-112 |
| Arsc Sandwich | $60M (1 month) | EP-112 |
| Magic Eden Fake NFTs | ~$15K | EP-113 (frontend) |
| The Heist ($NANA) | Unknown | EP-093 |
| Relay Protocol Ed25519 | $0 (patched) | EP-123 |
| Agave rBPF (Aug 2024) | Network DoS | EP-124 |
| Agave v3.0.14 (Jan 2026) | Network DoS | EP-124, EP-125 |
| ZK ElGamal #3 (Jan 2026) | $0 (patched) | EP-100 |
| SwissBorg/Kiln API (Sep 2025) | $41.5M | EP-095 (SC-7), EP-128 |
| CrediX (Aug 2025) | $4.5M | EP-073, EP-126 |
| Upbit Solana Hot-Wallet (Nov 2025) | $36M | EP-068, EP-097 |
| Step Finance (Jan 2026) | $30-40M | EP-068, EP-097 |
| Garden Finance (Oct 2025) | $11M | EP-058, EP-068 |
| GlassWorm Solana Memos C2 (Feb 2026) | N/A (abuse) | EP-095 (SC-8) |

<!-- Additional incidents from earlier index -->
| secp256r1 Eternal King | DoS | EP-106 |
| Solana SDK realloc OOB | Patched | EP-107 |
| ZK ElGamal #2 (Jun 2025) | $0 (patched) | EP-100 |
| Synthetify | $120K | EP-022, EP-089 |
| Jet Protocol | ~$100K | EP-022 |
| Parrot | $80M potential | EP-037 |
| Tulip | Critical (disclosed) | EP-007 |
| Solend | Governance | EP-066, EP-079 |
| Beanstalk (EVM lesson) | $182M | EP-114 |
| Euler Finance (EVM lesson) | $197M | EP-115 |
| C.R.E.A.M. Finance (EVM lesson) | $130M | EP-116 |
| Harvest Finance (EVM lesson) | $34M | EP-116 |
| Ronin Bridge V2 (EVM lesson) | $12M | EP-117 |
| Nomad Bridge (EVM lesson) | $190M | EP-117 (zero-default) |
| Harmony Bridge (EVM lesson) | $100M | EP-097 (2-of-5 threshold) |
| Multichain (EVM lesson) | $130M | EP-058 (single custodian) |
| MarginFi Flash Loan | $160M at risk | EP-118 |
| Curve/Vyper Reentrancy (EVM lesson) | $52M | Stale CPI data analog |
| Jupiter Flash Loan | $50M | EP-061, EP-118 |
| Solend Oracle (Nov 2022) | $1.26M | EP-021, EP-023 |

---

### Detection Quick Reference

| Grep Pattern | Exploit Patterns |
|-------------|-----------------|
| `AccountInfo` (without Signer/Account) | EP-001, EP-002, EP-006, EP-042, EP-049 |
| `+`, `-`, `*`, `/` (without `checked_`) | EP-015, EP-016 |
| `as u64`, `as u32` | EP-020 |
| `unwrap()`, `expect()` | EP-088 |
| `f32`, `f64` | EP-018 |
| `invoke()`, `invoke_signed()` | EP-042, EP-043, EP-044 |
| `get_return_data()` | EP-045 |
| `remaining_accounts` | EP-014, EP-050, EP-108 |
| `realloc()` | EP-012, EP-107 |
| `msg!` with variables | EP-070 |
| `unix_timestamp` in math | EP-089 |
| `pyth`, `oracle`, `price` | EP-021, EP-022, EP-023, EP-024, EP-096 |
| `let _ =` on CPI | EP-046 |
| `close` without constraint | EP-040 |
| Missing `min_amount_out` | EP-060 |
| `Vec<>` in account structs | EP-085, EP-088 |
| `load_instruction_at` (no `_checked`) | EP-092 |
| `checked_shl`, custom shift functions | EP-091 |
| `private_key`, `secret_key` in storage/logs | EP-097 |
| `withdraw_authority` single-key | EP-094 |
| `bonding_curve`, `migrate`, `graduation` | EP-094 |
| Off-chain `get_balance` → `debit_balance` | EP-093 |
| `package.json` unlocked versions | EP-095 |
| `rebalance`, `compound`, `migrate` + unchecked destination | EP-098 |
| `sort_by`, `cmp`, auction/bid logic | EP-099 |
| `confidential_transfer`, `zk_elgamal`, `ConfidentialMint` | EP-100 |
| `remove_liquidity` by admin, LP token concentration | EP-101 |
| `remaining_accounts` + registry/list/set loading | EP-102 |
| `get_associated_token_address` in migration/claim | EP-103 |
| `burn_tokens` before cross-chain confirmation | EP-104 |
| Fee collection without pool state update | EP-105 |
| `**account.lamports.borrow_mut()` to arbitrary account | EP-106 |
| `realloc` with user-controlled or unbounded size | EP-107 |
| `remaining_accounts[N]` without key/owner validation | EP-108 |
| `RoundDirection::Ceiling`, `RoundDirection::Floor` in deposit/withdraw | EP-109 |
| Multi-tx init (create in tx1, init in tx2) | EP-110 |
| Mutable config PDA read in fund-flow conditionals | EP-111 |
| `Clock::get()?.slot` in conditional fund routing | EP-111 |
| `min_amount_out == 0` or missing slippage check | EP-060, EP-112 |
| DNS/domain config, frontend hosting | EP-113 |
| Airdrop claim requiring transaction signing | EP-095 (SC-5) |
| `~/.config/solana/` file access in dependencies | EP-095 (SC-6) |
| Account close without ownership transfer to system program | EP-036 |
| `VoteTipping::Early` + `hold_up_time: 0` | EP-114 |
| `deposit_governing_tokens` without lock-up check | EP-114 |
| `donate`, `forfeit`, `contribute_to_reserve` without health check | EP-115 |
| `token::balance()` used for share pricing (vs internal tracking) | EP-116 |
| `total_assets / total_shares` without virtual reserves | EP-116 |
| New state fields after upgrade without migration call | EP-117 |
| `require!(value >= config.new_field)` where default is 0 | EP-117 |
| `flash_loan_active` not checked in migration/transfer instructions | EP-118 |
| Account transfer/delegation during active flash loan | EP-118 |
| `UncheckedAccount` for fee/revenue destination | EP-119 |
| Fee collection without creator/pool-owner validation | EP-119 |
| Single DEX pool as oracle price source | EP-120 |
| `SwitchboardV2` or `Pyth` with single feed per asset | EP-120 |
| `if expiration_time > 0` in multisig/guardian verification | EP-121 |
| Legacy/genesis keyset with `expiration_time == 0` | EP-121 |
| pNFT delegate transfer without Rule Set check | EP-122 |
| AllowList owner != destination token account owner | EP-122 |
| `burn` instruction without `token_record` validation | EP-122 |
| `load_instruction_at` + `ed25519_program` without offset validation | EP-123 |
| `Ed25519SignatureOffsets` used without verifying all offset fields | EP-123 |
| Protocol assumes continuous block production / network liveness | EP-124 |
| CPI depth hardcoded to 4 (now 8 in Agave 3.0) | EP-124 |
| Behavior relying on exact compute units or specific error codes | EP-125 |
| `grant_role`, `add_admin`, `ACLManager`, role assignment instructions | EP-126 |
| Multisig signer addition without timelock | EP-126 |
| `Bridge` role, `EmergencyAdmin`, `PoolAdmin` role grants | EP-126 |
| `mark_price`, `index_price`, funding rate calculation | EP-127 |
| `liquidate`, liquidation threshold, cascade | EP-127 |
| `max_position_size` per-account only (no aggregate check) | EP-127 |
| `SetAuthority` on stake accounts in third-party API transactions | EP-128 |
| Staking API transaction signing without instruction verification | EP-128 |
| Third-party constructed transactions signed without parsing | EP-128 |

---
<!-- END: exploit-patterns-index.md | Master index for 128 exploit patterns -->
<!-- Sources: Waves 1-10 research -->
