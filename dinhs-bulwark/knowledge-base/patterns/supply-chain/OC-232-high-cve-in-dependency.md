# OC-232: High CVE in Dependency

**Category:** Supply Chain & Dependencies
**Severity:** HIGH
**Auditors:** DEP-01
**CWE:** CWE-1395 (Dependency on Vulnerable Third-Party Component)
**OWASP:** A06:2021 -- Vulnerable and Outdated Components

## Description

A high-severity CVE (CVSS 7.0-8.9) in a direct or transitive dependency represents a significant security risk that, while not always immediately exploitable for full system compromise, provides attackers with a substantial foothold. High-severity vulnerabilities frequently enable denial of service, significant data exposure, or partial code execution that can be chained with other weaknesses for full compromise.

These vulnerabilities are common in the npm ecosystem. Research analyzing over 31,000 vulnerabilities across ecosystems from 2017 to 2025 found that the npm registry has the highest density of embedded malicious code (CWE-506) of any package ecosystem, accounting for 48.5% of all npm vulnerability reports. High-severity issues are particularly dangerous because they often linger: many development teams treat "high" as non-urgent compared to "critical," creating a window of exposure that can persist for months.

The ua-parser-js incident (CVE-2021-4229, October 2021) demonstrated how a hijacked package with a high-severity rating can introduce a cryptocurrency miner and credential-stealing trojan into applications. The compromised versions 0.7.29, 0.8.0, and 1.0.0 were downloaded by millions of users before discovery. More recently, the prototype pollution vulnerability in lodash (CVE-2020-8203) affected virtually every Node.js application and enabled denial of service or property injection attacks.

## Detection

```
npm audit --audit-level=high
yarn audit --level high

# List only high-severity findings
npm audit --json | jq '.vulnerabilities | to_entries[] | select(.value.severity == "high")'

# Check in CI pipeline
npx audit-ci --high
```

Look for: `npm audit` output with severity "high", outdated packages with known advisories, dependencies on packages with recent GHSA entries rated HIGH.

## Vulnerable Code

```json
{
  "dependencies": {
    "ua-parser-js": "0.7.29",
    "minimist": "1.2.5",
    "glob-parent": "5.1.1",
    "trim-newlines": "3.0.0",
    "semver": "7.3.7"
  }
}
```

## Secure Code

```json
{
  "dependencies": {
    "ua-parser-js": "^0.7.39",
    "minimist": "^1.2.8",
    "glob-parent": "^5.1.2",
    "trim-newlines": "^4.1.1",
    "semver": "^7.6.3"
  },
  "scripts": {
    "audit:high": "npm audit --audit-level=high",
    "postinstall": "npm audit --audit-level=high || echo 'WARNING: High severity vulnerabilities found'"
  }
}
```

## Impact

An attacker exploiting a high-severity dependency vulnerability can typically achieve denial of service, unauthorized data access, or partial code execution. In the ua-parser-js hijack, compromised versions installed cryptocurrency miners on Linux and macOS systems and deployed credential-stealing trojans on Windows. Prototype pollution vulnerabilities in widely-used libraries like lodash can be chained with application-specific gadgets to achieve remote code execution. In Solana dApp contexts, high-severity vulnerabilities in HTTP clients or parsing libraries can enable request interception, data manipulation, or service disruption.

## References

- CVE-2021-4229: ua-parser-js hijacked with crypto miner and trojan (October 2021, CVSS 8.8)
- CVE-2021-27292: ua-parser-js ReDoS vulnerability (CVSS 7.5)
- CVE-2020-8203: lodash prototype pollution (CVSS 7.4)
- CVE-2022-0155: follow-redirects data exposure (CVSS 8.0)
- Sonatype 2024 report: 512,847 malicious packages identified in one year
- OWASP A06:2021 -- Vulnerable and Outdated Components
