# OC-231: Critical CVE in Dependency

**Category:** Supply Chain & Dependencies
**Severity:** CRITICAL
**Auditors:** DEP-01
**CWE:** CWE-1395 (Dependency on Vulnerable Third-Party Component)
**OWASP:** A06:2021 -- Vulnerable and Outdated Components

## Description

A critical CVE in a direct or transitive dependency means the application inherits a known, publicly documented vulnerability with a CVSS score of 9.0 or higher. These vulnerabilities are actively cataloged, often with proof-of-concept exploits available, and are the first targets for automated scanners and opportunistic attackers.

The JavaScript/Node.js ecosystem is uniquely exposed. Sonatype's 2024 State of the Software Supply Chain report found over 704,000 malicious or vulnerable packages identified since 2019, with 512,847 in the past year alone -- a 156% year-over-year increase. The average npm project pulls in 79 transitive dependencies, meaning a single critical CVE can cascade through thousands of downstream applications. OWASP elevated Software Supply Chain Failures to the third most critical web application security risk in 2025.

Real-world incidents demonstrate the catastrophic impact. CVE-2024-54134 compromised @solana/web3.js versions 1.95.6 and 1.95.7 (CVSS 8.3), injecting private key exfiltration malware that drained cryptocurrency wallets. In September 2025, 18 popular npm packages including chalk and debug (collectively 2.6 billion weekly downloads) were compromised via phishing, deploying crypto-draining malware dubbed "Shai-Hulud" that exhibited worm-like propagation across the registry.

## Detection

```
npm audit --audit-level=critical
yarn audit --level critical
pnpm audit --audit-level=critical

# Check specific package
npm audit --json | jq '.vulnerabilities | to_entries[] | select(.value.severity == "critical")'

# Automated CI check
npx audit-ci --critical
```

Look for: `npm audit` output with severity "critical", GHSA advisories in `package-lock.json`, dependabot alerts, packages listed in the CISA Known Exploited Vulnerabilities catalog.

## Vulnerable Code

```json
{
  "dependencies": {
    "@solana/web3.js": "1.95.6",
    "jsonwebtoken": "8.5.1",
    "node-fetch": "2.6.0",
    "lodash": "4.17.20",
    "axios": "0.21.0"
  }
}
```

## Secure Code

```json
{
  "dependencies": {
    "@solana/web3.js": "^1.95.8",
    "jsonwebtoken": "^9.0.2",
    "node-fetch": "^2.7.0",
    "lodash": "^4.17.21",
    "axios": "^1.7.4"
  },
  "scripts": {
    "preinstall": "npx audit-ci --critical",
    "audit": "npm audit --audit-level=critical"
  }
}
```

## Impact

An attacker exploiting a critical CVE in a dependency can achieve remote code execution, data exfiltration, privilege escalation, or denial of service depending on the specific vulnerability. In cryptocurrency contexts, this directly translates to fund theft. The @solana/web3.js compromise (CVE-2024-54134) led to wallet draining within the 5-hour window the malicious versions were live. The September 2025 Shai-Hulud attack compromised over 500 packages through worm-like propagation, harvesting cloud API keys (AWS, GCP, Azure), npm tokens, and GitHub credentials.

## References

- CVE-2024-54134: @solana/web3.js supply chain compromise -- private key exfiltration (December 2024)
- September 2025 npm supply chain attack: 18 packages, 2.6B weekly downloads compromised (Shai-Hulud)
- Shai-Hulud 2.0 (November 2025): 796 packages with dead-man's-switch mechanism (GitLab, Datadog)
- Sonatype 2024 State of the Software Supply Chain: 704,000+ malicious packages since 2019
- OWASP A06:2021 -- Vulnerable and Outdated Components
- CWE-1395: https://cwe.mitre.org/data/definitions/1395.html
